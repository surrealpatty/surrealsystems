<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Services - Surreal Systems</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />

    <!-- ✅ Global theme FIRST -->
    <link rel="stylesheet" href="/style.css" />
    <!-- ✅ Page-specific styles (themed, includes modal + hides stray composer) -->
    <link rel="stylesheet" href="/services.css" />

    <!-- Init BEFORE script.js so API_URL is set -->
    <script src="init.js" defer></script>
    <!-- Shared helpers: theme, apiFetch, topUser chip, etc. -->
    <script src="script.js" defer></script>
    <!-- Page-specific logic -->
    <script src="services.js" defer></script>

    <style>
      /* Small layout-only safety net (DO NOT override theme colors) */
      body.dashboard {
        margin: 0;
        min-height: 100vh;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      }

      /* ✅ IMPORTANT: Hide the stray bottom-left composer if it exists */
      #messageBox,
      #messageForm,
      #messageSection,
      .message-box,
      .message-composer {
        display: none !important;
      }

      /* Ensure the modal is hidden until JS opens it */
      #messageModal {
        display: none;
      }
    </style>
  </head>

  <!-- Keep these classes for your existing JS toggle logic -->
  <body class="dashboard profile-page profile-dark">
    <div class="profile-wrapper">
      <header class="profile-header">
        <a href="index.html" class="profile-brand">
          <span class="profile-dot"></span>
          <span>Surreal Systems</span>
        </a>

        <!-- Top-right user pill (script.js will fill it) -->
        <div class="profile-user-pill" id="topUserChip">
          <div class="profile-avatar" id="topUserAvatar">U</div>
          <span class="profile-email" id="topUserEmail">you@example.com</span>
        </div>
      </header>

      <div class="profile-layout">
        <aside class="sidebar">
          <p class="sidebar-title">Dashboard</p>
          <ul class="nav-list">
            <li><a href="index.html" class="nav-link">Home</a></li>
            <li><a href="profile.html" class="nav-link">Profile</a></li>
            <li><a href="services.html" class="nav-link nav-link--active">Services</a></li>
            <li><a href="messages.html" class="nav-link">Messages</a></li>
            <li><a href="login.html" class="nav-link nav-link--danger">Logout</a></li>
          </ul>
        </aside>

        <main class="content-column">
          <section class="card">
            <h2>All services</h2>
            <p class="settings-subtitle">
              Browse everything users are offering across Surreal Systems.
            </p>

            <div class="controls" role="group" aria-label="Service search and sorting">
              <input
                id="search"
                class="input"
                placeholder="Search services..."
                aria-label="Search services"
              />

              <select id="sort" class="input" title="Sort services">
                <option value="newest">Newest</option>
                <option value="priceLow">Price: Low → High</option>
                <option value="priceHigh">Price: High → Low</option>
              </select>
            </div>

            <div id="services-list" aria-live="polite">
              <p class="loading"><span class="spinner"></span> Loading services...</p>
            </div>

            <div class="actions-row">
              <button type="button" id="refreshBtn" class="btn btn-primary">
                Refresh
              </button>

              <a href="profile.html" class="btn btn-muted">Back to Profile</a>
            </div>
          </section>
        </main>
      </div>

      <footer class="profile-footer">
        &copy; 2025 Surreal Systems. All rights reserved.
      </footer>
    </div>

    <!-- Message modal + toast (services.css styles this) -->
    <div
      id="messageModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="messageTitle"
      aria-hidden="true"
    >
      <div class="modal-content" role="document">
        <h2 id="messageTitle">
          Message <span id="messageRecipient"></span>
        </h2>

        <div class="field-wrap">
          <textarea
            id="messageContent"
            placeholder="Write your message..."
            maxlength="2000"
            aria-label="Message body"
          ></textarea>
        </div>

        <p id="sendError" class="error-inline" aria-live="polite" hidden></p>

        <div class="modal-meta">
          <span id="charCount" aria-live="polite">0 / 2000</span>
        </div>

        <div class="modal-actions">
          <button type="button" id="sendMessageBtn" class="btn btn-primary">Send</button>
          <button type="button" id="cancelMessageBtn" class="btn btn-muted">Cancel</button>
        </div>
      </div>
    </div>

    <div id="toast" role="status" aria-live="polite" aria-atomic="true"></div>
  </body>
</html>
